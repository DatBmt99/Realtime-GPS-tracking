<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/polymerfire/firebase-auth.html"><link rel="import" href="../../bower_components/paper-button/paper-button.html"><link rel="import" href="../../bower_components/paper-input/paper-input.html"></head><body><dom-module id="email-login-fire"><template><style>:host{display:block;margin:0 auto;}firebase-auth{display:none;}#reset{color:grey;text-decoration:none;font-size:12px;font-style:italic;font-weight:lighter;}#reset:hover{color:grey;text-decoration:underline;}.emailPWError{color:var(--error-color);text-align:center;font-size:16px;font-weight:500;line-height:24px;margin:0;padding:0;}.emailPWMessage{color:var(--primary-color);text-align:center;font-size:16px;font-weight:500;line-height:24px;margin:0;padding:0;}form{min-width:200px;margin:0 auto;}</style><firebase-auth app-name="{{appName}}" id="emailPassword" user="{{user}}" signed-in="{{signedIn}}" on-error="_handleEmailPWError" status-known="{{statusKnown}}"></firebase-auth><template is="dom-if" if="{{debug}}"><div class="debug"><div>user.id = {{user.uid}}</div><div>signedIn = {{signedIn}}</div><div>statusKnown = {{statusKnown}}</div><div>user.displayName = {{user.displayName}}</div><div>user.email = {{user.email}}</div><div>user.emailVerified = {{user.emailVerified}}</div><div>user.isAnonymous = {{user.isAnonymous}}</div><div>user.photoURL = {{user.photoURL}} <img src$="{{user.photoURL}}" hidden="{{!user.photoURL}}" width="100px" height="100px"></div><div>user.providerId = {{user.providerId}}</div><paper-button on-tap="signOut">Log Out</paper-button></div></template><div><div class="emailPWError"></div><div class="emailPWMessage"></div></div><form on-submit="_signInEmailPW"><paper-input id="emailInput" type="email" label="Email" value="{{email}}" validator="email-validator" error-message="Invalid email address" required="required" auto-validate="auto-validate"></paper-input><paper-input id="pwInput" type="password" label="Password" value="{{pw}}" required="required"></paper-input><p><a href="#" id="reset" on-click="_resetPW">Reset password for entered email</a></p><paper-button id="emailSignUp" type="submit" on-tap="_signUpEmailPW" hidden$="[[noSignUp]]">Sign Up</paper-button><paper-button id="emailSignIn" type="submit" on-tap="_signInEmailPW">Sign In</paper-button></form></template><script>class EmailLoginFire extends Polymer.Element{static get is(){return'email-login-fire'}static get properties(){return{appName:{type:String},user:{type:Object,notify:!0,reflectToAttribute:!0},signedIn:{type:Boolean,notify:!0,reflectToAttribute:!0},debug:{type:Boolean,value:!1},passwordResetMessage:{type:String,value:'Password reset email has been sent. Please check your inbox.'},noSignUp:{type:Boolean,value:!1},autoSignUp:{type:Boolean,value:!1},statusKnown:{type:Boolean,notify:!0}}}_userChanged(a){'undefined'===typeof a||null==a||0===Object.keys(a).length&&a.constructor===Object||this.dispatchEvent(new CustomEvent('email-signedin',{detail:a,bubbles:!0,composed:!0}))}_cleanMessages(){this.shadowRoot.querySelector('.emailPWError').textContent='',this.shadowRoot.querySelector('.emailPWMessage').textContent=''}_signInEmailPW(){this._cleanMessages(),console.log('email:'+this.email+' -pass:'+this.pw),this.shadowRoot.querySelector('#emailPassword').signInWithEmailAndPassword(this.email,this.pw)}_signUpEmailPW(){this.noSignUp||(this._cleanMessages(),this.shadowRoot.querySelector('#emailPassword').createUserWithEmailAndPassword(this.email,this.pw))}_handleEmailPWError(a){'auth/user-not-found'===a.detail.code&&this.autoSignUp?(this.shadowRoot.querySelector('#emailPassword').createUserWithEmailAndPassword(this.email,this.pw),this.email=null,this.pw=null):this.shadowRoot.querySelector('.emailPWError').textContent=a.detail.message}_resetPW(){var a=this;this._cleanMessages(),this.email?this.shadowRoot.querySelector('#emailPassword').auth.sendPasswordResetEmail(this.email).then(function(){a.shadowRoot.querySelector('.emailPWMessage').textContent=a.passwordResetMessage},function(b){a.shadowRoot.querySelector('.emailPWError').textContent=b.message}):this.shadowRoot.querySelector('.emailPWError').textContent='Please enter a valid email address.'}signOut(){this.signedIn&&this.$.emailPassword.signOut()}}customElements.define(EmailLoginFire.is,EmailLoginFire);</script></dom-module></body></html>